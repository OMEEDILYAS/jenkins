pipeline {
  agent any
  options { timestamps() }
  triggers { cron('H H * * 1') } // weekly (Mon). Adjust as needed.

  stages {
    stage('Send to queue') {
      steps {
        script {
          def jsonText = readFile('weekly/weekly.json')
          echo "Sending ${jsonText.length()} bytes from weekly.json to queue"
          build job: 'optimized/queue',
                wait: false,
                propagate: false,
                parameters: [
                  string(name: 'BATCH_JSON', value: jsonText),
                  string(name: 'SOURCE',     value: 'weekly')
                ]
        }
      }
    }
  }
}
