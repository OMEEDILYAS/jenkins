pipeline {
  agent none

  stages {
    stage('Run on all agents') {
      matrix {
        axes {
          axis {
            name 'AGENT'
            values 'agent-1', 'agent-2', 'agent-3', 'agent-4'
          }
        }

        agent { label "${AGENT}" }

        stages {
          stage('Sleep 20s') {
            steps {
              echo "Running on ${env.NODE_NAME}..."
              sleep 20
              echo "Finished on ${env.NODE_NAME}!"
            }
          }
        }
      }
    }
  }
}
